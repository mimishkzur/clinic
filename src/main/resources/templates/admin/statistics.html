<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            max-width: 800px;
            margin: 30px auto;
            display: block;
        }
        h2 {
            text-align: center;
        }
    </style>
</head>
<div th:insert="~{fragments/header_admin :: header}"></div>
<body>
<h1>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h1>

<h2>–ü—Ä–∏—ë–º—ã –ø–æ –¥–Ω—è–º</h2>
<canvas id="appointmentsPerDay"></canvas>

<h2>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –≤—Ä–∞—á–µ–π</h2>
<canvas id="appointmentsPerDoctor"></canvas>

<h2>–°—Ç–∞—Ç—É—Å—ã –ø—Ä–∏—ë–º–æ–≤</h2>
<canvas id="appointmentStatuses"></canvas>

<script th:inline="javascript">
    /*<![CDATA[*/

    const appointmentsPerDayLabels = [[${appointmentsPerDay.keySet()}]];
    const appointmentsPerDayData = [[${appointmentsPerDay.values()}]];

    const appointmentsPerDoctorLabels = [[${appointmentsPerDoctor.keySet()}]];
    const appointmentsPerDoctorData = [[${appointmentsPerDoctor.values()}]];

    const statusLabels = [[${statusCounts.keySet()}]];
    const statusData = [[${statusCounts.values()}]];

    // üìÖ –ü—Ä–∏—ë–º—ã –ø–æ –¥–Ω—è–º
    new Chart(document.getElementById("appointmentsPerDay"), {
        type: 'bar',
        data: {
            labels: appointmentsPerDayLabels,
            datasets: [{
                label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–æ–≤',
                data: appointmentsPerDayData,
                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: { responsive: true }
    });

    // üßë‚Äç‚öïÔ∏è –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –≤—Ä–∞—á–µ–π
    new Chart(document.getElementById("appointmentsPerDoctor"), {
        type: 'bar',
        data: {
            labels: appointmentsPerDoctorLabels,
            datasets: [{
                label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–æ–≤',
                data: appointmentsPerDoctorData,
                backgroundColor: 'rgba(255, 206, 86, 0.7)',
                borderColor: 'rgba(255, 206, 86, 1)',
                borderWidth: 1
            }]
        },
        options: { responsive: true }
    });

    // üìà –°—Ç–∞—Ç—É—Å—ã –ø—Ä–∏—ë–º–æ–≤
    new Chart(document.getElementById("appointmentStatuses"), {
        type: 'pie',
        data: {
            labels: statusLabels,
            datasets: [{
                label: '–°—Ç–∞—Ç—É—Å',
                data: statusData,
                backgroundColor: [
                    'rgba(75, 192, 192, 0.7)', // AVAILABLE
                    'rgba(255, 159, 64, 0.7)', // SCHEDULED
                    'rgba(153, 102, 255, 0.7)' // COMPLETED
                ],
                borderColor: '#fff',
                borderWidth: 1
            }]
        },
        options: { responsive: true }
    });

    /*]]>*/
</script>
</body>
</html>
